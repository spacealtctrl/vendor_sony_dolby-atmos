r_dir_file(hal_audio_default, vendor_threesixtyra_data_file)

# DMS HAL needs to access /data/vendor/dolby for parameter storage
allow hal_audio_default vendor_data_file:dir { create read write open getattr setattr search add_name remove_name };
allow hal_audio_default vendor_data_file:file { create read write open getattr setattr unlink rename lock ioctl };

allow hal_audio_default vendor_hal_secd_hwservice:hwservice_manager { find };

# Allow hal_audio_default to call itself (needed for DMS HAL internal IPC)
allow hal_audio_default hal_audio_default:binder { call transfer };

# Allow bidirectional binder communication with platform_app (daxService)
binder_call(hal_audio_default, platform_app)

# Allow bidirectional binder communication with audioserver
binder_call(hal_audio_default, audioserver)

allow hal_audio_default gpu_device:chr_file rw_file_perms;

allow hal_audio_default vendor_hal_secd_default:binder { call };
allow hal_audio_default vendor_tee_listener_prop:file { read open getattr map };
allow hal_audio_default vendor_camera_running_status_prop:file { read open getattr map };
allow hal_audio_default vendor_camera_sensor_prop:file { read open getattr map };

set_prop(hal_audio_default, vendor_sony_spatializer_dolby_prop)
